<html><head><meta content="text/html; charset=UTF-8" http-equiv="content-type"><style type="text/css">.lst-kix_mrm5lwrfmgc7-7>li{counter-increment:lst-ctn-kix_mrm5lwrfmgc7-7}ul.lst-kix_c2d6v23nv4c7-5{list-style-type:none}ul.lst-kix_c2d6v23nv4c7-6{list-style-type:none}ul.lst-kix_c2d6v23nv4c7-3{list-style-type:none}ul.lst-kix_c2d6v23nv4c7-4{list-style-type:none}ul.lst-kix_c2d6v23nv4c7-1{list-style-type:none}ul.lst-kix_c2d6v23nv4c7-2{list-style-type:none}.lst-kix_jte6gwof2bn9-3>li:before{content:"\0025cf   "}ul.lst-kix_c2d6v23nv4c7-0{list-style-type:none}.lst-kix_jte6gwof2bn9-2>li:before{content:"\0025a0   "}ul.lst-kix_c2d6v23nv4c7-7{list-style-type:none}ul.lst-kix_c2d6v23nv4c7-8{list-style-type:none}.lst-kix_jte6gwof2bn9-0>li:before{content:"\0025cf   "}.lst-kix_jte6gwof2bn9-1>li:before{content:"\0025cb   "}ol.lst-kix_u6cd56cvefnu-2.start{counter-reset:lst-ctn-kix_u6cd56cvefnu-2 0}ol.lst-kix_u6cd56cvefnu-5.start{counter-reset:lst-ctn-kix_u6cd56cvefnu-5 0}ol.lst-kix_mrm5lwrfmgc7-2.start{counter-reset:lst-ctn-kix_mrm5lwrfmgc7-2 0}.lst-kix_mrm5lwrfmgc7-8>li{counter-increment:lst-ctn-kix_mrm5lwrfmgc7-8}.lst-kix_mrm5lwrfmgc7-5>li{counter-increment:lst-ctn-kix_mrm5lwrfmgc7-5}.lst-kix_mrm5lwrfmgc7-4>li:before{content:"" counter(lst-ctn-kix_mrm5lwrfmgc7-4,lower-latin) ". "}ol.lst-kix_mrm5lwrfmgc7-6{list-style-type:none}ol.lst-kix_mrm5lwrfmgc7-5{list-style-type:none}ol.lst-kix_mrm5lwrfmgc7-8{list-style-type:none}.lst-kix_u6cd56cvefnu-1>li{counter-increment:lst-ctn-kix_u6cd56cvefnu-1}ol.lst-kix_mrm5lwrfmgc7-7{list-style-type:none}.lst-kix_mrm5lwrfmgc7-2>li:before{content:"" counter(lst-ctn-kix_mrm5lwrfmgc7-2,lower-roman) ". "}.lst-kix_mrm5lwrfmgc7-3>li:before{content:"" counter(lst-ctn-kix_mrm5lwrfmgc7-3,decimal) ". "}.lst-kix_mrm5lwrfmgc7-0>li:before{content:"" counter(lst-ctn-kix_mrm5lwrfmgc7-0,decimal) ". "}ol.lst-kix_mrm5lwrfmgc7-0{list-style-type:none}ol.lst-kix_mrm5lwrfmgc7-2{list-style-type:none}ol.lst-kix_mrm5lwrfmgc7-1{list-style-type:none}.lst-kix_mrm5lwrfmgc7-1>li:before{content:"" counter(lst-ctn-kix_mrm5lwrfmgc7-1,lower-latin) ". "}ol.lst-kix_mrm5lwrfmgc7-4{list-style-type:none}ol.lst-kix_mrm5lwrfmgc7-3{list-style-type:none}.lst-kix_mrm5lwrfmgc7-4>li{counter-increment:lst-ctn-kix_mrm5lwrfmgc7-4}.lst-kix_u6cd56cvefnu-2>li{counter-increment:lst-ctn-kix_u6cd56cvefnu-2}.lst-kix_u6cd56cvefnu-8>li{counter-increment:lst-ctn-kix_u6cd56cvefnu-8}.lst-kix_mrm5lwrfmgc7-5>li:before{content:"" counter(lst-ctn-kix_mrm5lwrfmgc7-5,lower-roman) ". "}ol.lst-kix_mrm5lwrfmgc7-5.start{counter-reset:lst-ctn-kix_mrm5lwrfmgc7-5 0}.lst-kix_mrm5lwrfmgc7-6>li:before{content:"" counter(lst-ctn-kix_mrm5lwrfmgc7-6,decimal) ". "}.lst-kix_mrm5lwrfmgc7-7>li:before{content:"" counter(lst-ctn-kix_mrm5lwrfmgc7-7,lower-latin) ". "}.lst-kix_mrm5lwrfmgc7-8>li:before{content:"" counter(lst-ctn-kix_mrm5lwrfmgc7-8,lower-roman) ". "}.lst-kix_u6cd56cvefnu-7>li:before{content:"" counter(lst-ctn-kix_u6cd56cvefnu-7,lower-latin) ". "}.lst-kix_u6cd56cvefnu-8>li:before{content:"" counter(lst-ctn-kix_u6cd56cvefnu-8,lower-roman) ". "}.lst-kix_c2d6v23nv4c7-5>li:before{content:"\0025a0   "}.lst-kix_u6cd56cvefnu-6>li:before{content:"" counter(lst-ctn-kix_u6cd56cvefnu-6,decimal) ". "}.lst-kix_c2d6v23nv4c7-4>li:before{content:"\0025cb   "}.lst-kix_c2d6v23nv4c7-1>li:before{content:"\0025cb   "}.lst-kix_c2d6v23nv4c7-3>li:before{content:"\0025cf   "}ol.lst-kix_u6cd56cvefnu-4.start{counter-reset:lst-ctn-kix_u6cd56cvefnu-4 0}.lst-kix_u6cd56cvefnu-1>li:before{content:"" counter(lst-ctn-kix_u6cd56cvefnu-1,lower-latin) ". "}.lst-kix_c2d6v23nv4c7-2>li:before{content:"\0025a0   "}.lst-kix_jte6gwof2bn9-4>li:before{content:"\0025cb   "}.lst-kix_jte6gwof2bn9-5>li:before{content:"\0025a0   "}ol.lst-kix_mrm5lwrfmgc7-4.start{counter-reset:lst-ctn-kix_mrm5lwrfmgc7-4 0}.lst-kix_u6cd56cvefnu-2>li:before{content:"" counter(lst-ctn-kix_u6cd56cvefnu-2,lower-roman) ". "}.lst-kix_jte6gwof2bn9-6>li:before{content:"\0025cf   "}.lst-kix_u6cd56cvefnu-3>li:before{content:"" counter(lst-ctn-kix_u6cd56cvefnu-3,decimal) ". "}.lst-kix_c2d6v23nv4c7-0>li:before{content:"\0025cf   "}.lst-kix_u6cd56cvefnu-4>li:before{content:"" counter(lst-ctn-kix_u6cd56cvefnu-4,lower-latin) ". "}.lst-kix_jte6gwof2bn9-8>li:before{content:"\0025a0   "}.lst-kix_u6cd56cvefnu-5>li:before{content:"" counter(lst-ctn-kix_u6cd56cvefnu-5,lower-roman) ". "}.lst-kix_jte6gwof2bn9-7>li:before{content:"\0025cb   "}.lst-kix_mrm5lwrfmgc7-1>li{counter-increment:lst-ctn-kix_mrm5lwrfmgc7-1}ol.lst-kix_mrm5lwrfmgc7-6.start{counter-reset:lst-ctn-kix_mrm5lwrfmgc7-6 0}ul.lst-kix_jte6gwof2bn9-8{list-style-type:none}.lst-kix_u6cd56cvefnu-5>li{counter-increment:lst-ctn-kix_u6cd56cvefnu-5}ul.lst-kix_jte6gwof2bn9-5{list-style-type:none}ul.lst-kix_jte6gwof2bn9-4{list-style-type:none}ul.lst-kix_jte6gwof2bn9-7{list-style-type:none}ul.lst-kix_jte6gwof2bn9-6{list-style-type:none}.lst-kix_u6cd56cvefnu-0>li:before{content:"" counter(lst-ctn-kix_u6cd56cvefnu-0,decimal) ". "}ol.lst-kix_mrm5lwrfmgc7-3.start{counter-reset:lst-ctn-kix_mrm5lwrfmgc7-3 0}.lst-kix_c2d6v23nv4c7-6>li:before{content:"\0025cf   "}ol.lst-kix_u6cd56cvefnu-6.start{counter-reset:lst-ctn-kix_u6cd56cvefnu-6 0}.lst-kix_c2d6v23nv4c7-7>li:before{content:"\0025cb   "}.lst-kix_c2d6v23nv4c7-8>li:before{content:"\0025a0   "}.lst-kix_mrm5lwrfmgc7-2>li{counter-increment:lst-ctn-kix_mrm5lwrfmgc7-2}ol.lst-kix_u6cd56cvefnu-2{list-style-type:none}.lst-kix_u6cd56cvefnu-4>li{counter-increment:lst-ctn-kix_u6cd56cvefnu-4}ul.lst-kix_jte6gwof2bn9-1{list-style-type:none}ol.lst-kix_u6cd56cvefnu-1{list-style-type:none}ul.lst-kix_jte6gwof2bn9-0{list-style-type:none}ol.lst-kix_u6cd56cvefnu-4{list-style-type:none}.lst-kix_u6cd56cvefnu-7>li{counter-increment:lst-ctn-kix_u6cd56cvefnu-7}ul.lst-kix_jte6gwof2bn9-3{list-style-type:none}ol.lst-kix_u6cd56cvefnu-3{list-style-type:none}ol.lst-kix_u6cd56cvefnu-3.start{counter-reset:lst-ctn-kix_u6cd56cvefnu-3 0}ul.lst-kix_jte6gwof2bn9-2{list-style-type:none}ol.lst-kix_u6cd56cvefnu-6{list-style-type:none}ol.lst-kix_u6cd56cvefnu-5{list-style-type:none}ol.lst-kix_u6cd56cvefnu-8{list-style-type:none}ol.lst-kix_u6cd56cvefnu-7{list-style-type:none}ol.lst-kix_u6cd56cvefnu-0{list-style-type:none}ol.lst-kix_u6cd56cvefnu-0.start{counter-reset:lst-ctn-kix_u6cd56cvefnu-0 0}ol.lst-kix_u6cd56cvefnu-7.start{counter-reset:lst-ctn-kix_u6cd56cvefnu-7 0}ol.lst-kix_mrm5lwrfmgc7-1.start{counter-reset:lst-ctn-kix_mrm5lwrfmgc7-1 0}ol.lst-kix_mrm5lwrfmgc7-8.start{counter-reset:lst-ctn-kix_mrm5lwrfmgc7-8 0}.lst-kix_u6cd56cvefnu-6>li{counter-increment:lst-ctn-kix_u6cd56cvefnu-6}ol.lst-kix_mrm5lwrfmgc7-7.start{counter-reset:lst-ctn-kix_mrm5lwrfmgc7-7 0}ol.lst-kix_mrm5lwrfmgc7-0.start{counter-reset:lst-ctn-kix_mrm5lwrfmgc7-0 0}.lst-kix_u6cd56cvefnu-3>li{counter-increment:lst-ctn-kix_u6cd56cvefnu-3}li.li-bullet-0:before{margin-left:-18pt;white-space:nowrap;display:inline-block;min-width:18pt}.lst-kix_u6cd56cvefnu-0>li{counter-increment:lst-ctn-kix_u6cd56cvefnu-0}ol.lst-kix_u6cd56cvefnu-8.start{counter-reset:lst-ctn-kix_u6cd56cvefnu-8 0}.lst-kix_mrm5lwrfmgc7-3>li{counter-increment:lst-ctn-kix_mrm5lwrfmgc7-3}.lst-kix_mrm5lwrfmgc7-0>li{counter-increment:lst-ctn-kix_mrm5lwrfmgc7-0}ol.lst-kix_u6cd56cvefnu-1.start{counter-reset:lst-ctn-kix_u6cd56cvefnu-1 0}.lst-kix_mrm5lwrfmgc7-6>li{counter-increment:lst-ctn-kix_mrm5lwrfmgc7-6}ol{margin:0;padding:0}table td,table th{padding:0}.c1{border-right-style:solid;padding-top:0pt;border-top-width:0pt;border-right-width:0pt;padding-left:0pt;padding-bottom:0pt;line-height:1.15;border-left-width:0pt;border-top-style:solid;margin-left:36pt;border-left-style:solid;border-bottom-width:0pt;border-bottom-style:solid;orphans:2;widows:2;text-align:left;padding-right:0pt}.c3{border-right-style:solid;padding-top:0pt;border-top-width:0pt;border-right-width:0pt;padding-left:0pt;padding-bottom:0pt;line-height:1.15;border-left-width:0pt;border-top-style:solid;border-left-style:solid;border-bottom-width:0pt;border-bottom-style:solid;orphans:2;widows:2;text-align:left;padding-right:0pt}.c0{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:11pt;font-family:"Arial";font-style:normal}.c2{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:20pt;font-family:"Arial";font-style:normal}.c6{padding-top:20pt;padding-bottom:6pt;line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.c4{color:#000000;font-weight:400;text-decoration:none;vertical-align:baseline;font-size:16pt;font-family:"Arial";font-style:normal}.c5{padding-top:0pt;padding-bottom:0pt;line-height:1.15;orphans:2;widows:2;text-align:left}.c7{text-decoration-skip-ink:none;-webkit-text-decoration-skip:none;color:#1155cc;font-weight:700;text-decoration:underline}.c10{text-decoration-skip-ink:none;-webkit-text-decoration-skip:none;color:#0000ee;text-decoration:underline}.c14{background-color:#ffffff;max-width:451.4pt;padding:72pt 72pt 72pt 72pt}.c8{color:inherit;text-decoration:inherit}.c11{padding:0;margin:0}.c12{page-break-after:avoid}.c9{height:11pt}.c13{font-weight:700}.title{padding-top:0pt;color:#000000;font-size:26pt;padding-bottom:3pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}.subtitle{padding-top:0pt;color:#666666;font-size:15pt;padding-bottom:16pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}li{color:#000000;font-size:11pt;font-family:"Arial"}p{margin:0;color:#000000;font-size:11pt;font-family:"Arial"}h1{padding-top:20pt;color:#000000;font-size:20pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h2{padding-top:18pt;color:#000000;font-size:16pt;padding-bottom:6pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h3{padding-top:16pt;color:#434343;font-size:14pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h4{padding-top:14pt;color:#666666;font-size:12pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h5{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;orphans:2;widows:2;text-align:left}h6{padding-top:12pt;color:#666666;font-size:11pt;padding-bottom:4pt;font-family:"Arial";line-height:1.15;page-break-after:avoid;font-style:italic;orphans:2;widows:2;text-align:left}</style></head><body class="c14 doc-content"><h1 class="c6" id="h.q0p6es1w44aa"><span class="c2">OStore Order Placement Flow Design</span></h1><p class="c5 c9"><span class="c0"></span></p><p class="c5"><span class="c0">OStore is an e-commerce website that sells all categories of products over the internet. This document explains the high level design of the order placement journey on the backend.</span></p><h2 class="c3 c12" id="h.huw7mn6jeral"><span class="c4">Components</span></h2><p class="c5"><span class="c0">The system consists of the following components (servers).</span></p><ol class="c11 lst-kix_mrm5lwrfmgc7-0 start" start="1"><li class="c1 li-bullet-0"><span class="c13">Frontend Service:</span><span>&nbsp;</span><span>Provides a user interface for browsing products, managing shopping </span><span>cart</span><span class="c0">&nbsp;and placing orders.</span></li><li class="c1 li-bullet-0"><span class="c7"><a class="c8" href="https://www.google.com/url?q=https://docs.google.com/document/d/1KCxn4jyPlwn9BfTKZ9WvunTGBCXtU83HgGAoaiUNwUM/edit%23heading%3Dh.3v4xlitgwdd0&amp;sa=D&amp;source=editors&amp;ust=1708359004573410&amp;usg=AOvVaw3Nk22do-aEvFWqg2jMgNTs">Order Management Service</a></span><span class="c13">:</span><span class="c0">&nbsp;Facilitates order processing, including order placement, payment processing, and order fulfillment.</span></li><li class="c1 li-bullet-0"><span class="c7"><a class="c8" href="https://www.google.com/url?q=https://docs.google.com/document/d/1BgkNku_xJyYK3A6fLA3-yJ63BFBRI-hjP_oB8KsU9lk/edit&amp;sa=D&amp;source=editors&amp;ust=1708359004573631&amp;usg=AOvVaw2URnfQPA4jFZepBAk66FgG">Product Catalog Service:</a></span><span class="c0">&nbsp;Manages the inventory of products, including CRUD operations for products and categories.</span></li><li class="c1 li-bullet-0"><span class="c7"><a class="c8" href="https://www.google.com/url?q=https://docs.google.com/document/d/1nQnRgZOElsoQNGIxm7awykEOghufbfk_3ZGITq4aipg/edit&amp;sa=D&amp;source=editors&amp;ust=1708359004573807&amp;usg=AOvVaw3QupTXXTP3ZqG9imRk-W_r">Shipment Tracking Service:</a></span><span class="c0">&nbsp;Creates shipments for orders and manages the tracking of shipments.</span></li><li class="c1 li-bullet-0"><span class="c13">User Notification Service:</span><span class="c0">&nbsp;Responsible for communicating with users over email or text messages. This service provides updates to users about their order statuses.</span></li><li class="c1 li-bullet-0"><span class="c7"><a class="c8" href="https://www.google.com/url?q=https://kafka.apache.org/&amp;sa=D&amp;source=editors&amp;ust=1708359004574015&amp;usg=AOvVaw3P0zyT8wnuG7Qry-eCgYnp">Apache Kafka:</a></span><span class="c0">&nbsp;Message Broker responsible for managing the event bus that decouples (using producer and consumers) communication between multiple services in the system. </span></li></ol><p class="c3"><span>All these components have separate binaries in production. Unlike traditional microservices design, all these components use the same </span><span class="c13">PostgreSQL database</span><span class="c0">&nbsp;to perform CRUD operations. That means each Service can access and update the database tables independently. We chose this approach because it is simpler given our current scale to not have to maintain multiple databases in production. As the website scales, we might migrate to a full microservices based system with each service maintaining its own database.</span></p><p class="c3"><span>All the components above (including the Postgres database and Kafka brokers) are deployed on </span><span class="c13">AWS (Amazon Web Services)</span><span>&nbsp;in production.</span></p><p class="c3"><span>System Architecture diagram: </span><span class="c10"><a class="c8" href="https://www.google.com/url?q=https://docs.google.com/drawings/d/1dCK0lp1uRv7_bdoUuiP9lYmJCaJAO2DM7JEw1osYW48/edit?usp%3Dsharing&amp;sa=D&amp;source=editors&amp;ust=1708359004574422&amp;usg=AOvVaw1FSG7EOFUPhVlJb5dqUKFE">OStore System Architecture</a></span></p><h2 class="c3 c12" id="h.41kcg1bo4nwc"><span class="c4">Order placement flow</span></h2><p class="c3"><span class="c0">Here are the steps in the order placement flow:</span></p><ol class="c11 lst-kix_u6cd56cvefnu-0 start" start="1"><li class="c1 li-bullet-0"><span class="c0">The customer arrives at the OStore website on their browser and that triggers a request to the Frontend Service.</span></li><li class="c1 li-bullet-0"><span class="c0">The Frontend Service returns the web page where the user can search and look up details of different products under various categories. The user can select different products and add them to their cart.</span></li><li class="c1 li-bullet-0"><span class="c0">When they are ready, they place the order on the website.</span></li><li class="c1 li-bullet-0"><span class="c0">The frontend client receives the order request and forwards it to the order management service.</span></li><li class="c1 li-bullet-0"><span class="c0">The Order Management Service (OMS) receives the order details and calls the Product Catalog Service to check if there is enough quantity for each product in the cart.</span></li><li class="c1 li-bullet-0"><span class="c0">If there isn&rsquo;t enough stock, then the Order Management Service (OMS) returns an error to the frontend server which in turns returns an error to the browser prompting the user to remove it from the cart.</span></li><li class="c1 li-bullet-0"><span class="c0">If there is enough stock, then the OMS calls the Shipment Tracking Service to create a shipment.</span></li><li class="c1 li-bullet-0"><span class="c0">The Shipment Tracking Services creates a shipment with one of the carriers and returns the confirmation quickly to the OMS. At the same time, a queue job is enqueued by the Shipment Tracking Service to complete shipment processing. Once that processing is complete, another periodic queue job is created to track the shipment until it is delivered.</span></li><li class="c1 li-bullet-0"><span class="c0">During shipment tracking, if the status of the order changes, the Shipment Tracking service produces an event to Kafka which is then consumed by the Order Management System. The OMS updates the User Notification Service which then sends the update to the user via an email or text message.</span></li></ol><p class="c3"><span class="c0">Please refer to the other documents linked above to learn more detailed information.</span></p><p class="c3 c9"><span class="c0"></span></p></body></html>